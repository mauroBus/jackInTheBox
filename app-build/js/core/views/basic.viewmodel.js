define(["class","knockout","jquery","jqueryui","pubsub"],function(e,t,n,r,i){var s=Class.extend({defaultEffects:{onShow:{effect:"fade",easing:"linear",mode:"show",duration:650},onHide:{effect:"fade",easing:"linear",mode:"hide",direction:"up",duration:400}},template:"",el:"",$el:null,effects:{},uuid:null,state:null,staticId:{value:0},_familyChannel:null,init:function(e){this.effects=n.extend(!0,{},this.defaultEffects),e?(this.template=this.template||e.template||"",this.el=e.el||"div",this.setEffects(e.effects)):(this.template="dummy HTML content...",this.el="div"),this.state="initialized",this.uuid=this.staticId.value++,this.initialize.apply(this,arguments)},initialize:function(){},render:function(){this.$el=n(this.el);if(!this.$el)throw new Error("Brawler <BasicViewModel>: view's element is not in the DOM");return this.$el.hide(),this.$el.html(this.template),this.dataBind&&this.insertDinamicBindings(),t.applyBindings(this,this.$el[0]),this.postRender(),this.state="rendered",this},postRender:function(){},show:function(e){var t=new n.Deferred;if(this.state==="showed")return t.resolve(),t.promise();var r;return e&&typeof e=="object"?r=n.extend(!0,{},this.effects.onShow,e):r=this.effects.onShow,r.complete=function(){t.resolve()},this.$el.effect(r),this.state="showed",t.promise()},hide:function(e){var t=new n.Deferred;if(this.state==="hiden")return t.resolve(),t.promise();var r;return e&&typeof e=="object"?r=n.extend(!0,{},this.effects.onHide,e):r=this.effects.onHide,r.complete=function(){t.resolve()},this.$el.effect(r),this.state="hiden",t.promise()},toggle:function(e){switch(this.state){case"showed":return this.hide(e);case"hiden":return this.show(e);case"rendered":return this.show(e);default:throw new Error("This view ("+this.el+') is in the state "'+this.state+'" and cannot be toggled')}},setShowEffects:function(e){e&&typeof e=="object"&&n.extend(!0,this.effects.onShow,e)},setHideEffects:function(e){e&&typeof e=="object"&&n.extend(!0,this.effects.onHide,e)},setEffects:function(e){e&&typeof e=="object"&&n.extend(!0,this.effects,e)},remove:function(){this.$el.html(""),delete this.el,delete this.$el,delete this.template,delete this.effects,delete this.defaultEffects},getUUID:function(e){var t="yyxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)});return(e||"")+t},parseBindingsToString:function(e){var t=[];for(var n in e){var r=e[n];switch(typeof r){case"string":t.push(n+":"+r);break;case"object":t.push(n+":{"+this.parseBindingsToString(r)+"}");break;case"function":t.push(n+":"+r.toString())}}return t.join(",")},insertDinamicBindings:function(){var e,t,r,i;for(e in this.dataBind)t=this.parseBindingsToString(this.dataBind[e]),t&&(r=n(this.el+" "+e),r.attr("data-bind",t))},setFamilyChannel:function(e){this._familyChannel=e,this._familyChannel.augment(this,"on","off","trigger")}});return s});